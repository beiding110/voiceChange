{"version":3,"file":"./voiceChanger.js","mappings":"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","sources":["webpack://voiceChanger/webpack/universalModuleDefinition","webpack://voiceChanger/./index.js","webpack://voiceChanger/./jungle.js","webpack://voiceChanger/webpack/bootstrap","webpack://voiceChanger/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"voiceChanger\"] = factory();\n\telse\n\t\troot[\"voiceChanger\"] = factory();\n})(self, () => {\nreturn ","const Jungle = require('./jungle.js');\r\n\r\nvar audioContext = null;\r\nvar audioInput = null;\r\nvar effectInput = null;\r\nvar wetGain = null;\r\nvar dryGain = null;\r\nvar outputMix = null;\r\nvar currentEffectNode = null;\r\n\r\nvar _streamOrg = null;\r\nvar _stream = null;\r\n\r\n// 转换成单声道\r\nfunction convertToMono(input) {\r\n    // access the individual channels of an audio stream and process them separately.\r\n    // 访问音频通道\r\n    // 分割成的声道道数目\r\n    var splitter = audioContext.createChannelSplitter(2);\r\n    var merger = audioContext.createChannelMerger(2);\r\n\r\n    // 将一个节点的输出连接到一个指定目标\r\n    // destination 需要连接的\r\n    // outputIndex 一个索引，用于描述当前 AudioNode 的哪个输出会连接到 destination。索引数字是由输出频道（详见 Audio channels）的数量来确定的。\r\n    // inputIndex 一个索引，用于描述当前 AudioNode 会连接到 destination 的哪个输入，它的默认值是 0。索引数字是由输入频道（详见 Audio channels）的数量来确定的。\r\n    input.connect(splitter);\r\n    splitter.connect(merger, 0, 0);\r\n    splitter.connect(merger, 0, 1);\r\n    \r\n    return merger;\r\n}\r\n\r\nfunction gotStream(stream) {\r\n    // Create an AudioNode from the stream.\r\n    // 关联可能来自本地计算机麦克风或其他来源的音频流\r\n    var input = audioContext.createMediaStreamSource(stream);\r\n\r\n    audioInput = convertToMono(input);\r\n\r\n    // create mix gain nodes\r\n    outputMix = audioContext.createGain();\r\n    dryGain = audioContext.createGain();\r\n    wetGain = audioContext.createGain();\r\n    effectInput = audioContext.createGain();\r\n    \r\n    audioInput.connect(dryGain);\r\n    audioInput.connect(effectInput);\r\n    dryGain.connect(outputMix);\r\n    wetGain.connect(outputMix);\r\n    // outputMix.connect(audioContext.destination);\r\n\r\n    crossfade(1.0);\r\n}\r\n\r\n// 交叉混合\r\nfunction crossfade(value) {\r\n    // equal-power crossfade\r\n    var gain1 = Math.cos(value * 0.5 * Math.PI);\r\n    var gain2 = Math.cos((1.0 - value) * 0.5 * Math.PI);\r\n\r\n    dryGain.gain.value = gain1;\r\n    wetGain.gain.value = gain2;\r\n}\r\n\r\n/**\r\n * 增加效果\r\n * @param {Number} val 变声的控制系数[-1, 1]\r\n */\r\nfunction changeEffect(val = .7) {\r\n    if (currentEffectNode) {\r\n        currentEffectNode.disconnect();\r\n    }\r\n\r\n    if (effectInput) {\r\n        effectInput.disconnect();\r\n    }\r\n\r\n    var effect = new Jungle(audioContext);\r\n    \r\n    effect.output.connect(wetGain);\r\n    currentEffectNode = effect.input;\r\n    effect.setPitchOffset(val); // 设置变声系数[-1, 1]，越大越尖锐\r\n\r\n    audioInput.connect(currentEffectNode);\r\n}\r\n\r\n/**\r\n * 获取变声后的数据流\r\n * @param {Object} stream 已有的音频数据流，非必要\r\n * @param {Number} val 变声控制系数[-1, 1]，非必要\r\n * @returns \r\n */\r\nasync function voiceChanger(stream, val) {\r\n    return new Promise((res, reg) => {\r\n        // 音频上下文\r\n        audioContext = new AudioContext();\r\n\r\n        if (stream) {\r\n            // 有音频流，直接使用\r\n            _streamOrg = stream;\r\n\r\n            if (_streamOrg.getAudioTracks().length) {\r\n                gotStream(_streamOrg);\r\n            \r\n                changeEffect(val);\r\n\r\n                getNewStream();\r\n\r\n                res(_stream);\r\n            } else {\r\n                res(_streamOrg);\r\n            }\r\n        } else {\r\n            // 没有音频流，获取麦克风的音频流\r\n            if (!navigator.getUserMedia) {\r\n                return alert('错误：您的浏览器过于落后，不支持getUserMedia，请使用chrome、edge等现代浏览器');\r\n            }\r\n\r\n            navigator.getUserMedia({ audio: true }, stream => {\r\n                _streamOrg = stream;\r\n\r\n                gotStream(_streamOrg);\r\n\r\n                changeEffect(val);\r\n\r\n                getNewStream();\r\n\r\n                res(_stream);\r\n            }, e => {\r\n                alert('错误：获取音频权限失败');\r\n                console.log(e);\r\n\r\n                rej(e);\r\n            });\r\n        }\r\n    })\r\n}\r\n\r\n// 将context转化为stream\r\nfunction getNewStream() {\r\n    var destination = audioContext.createMediaStreamDestination(),\r\n        handledStream = destination.stream;\r\n\r\n    outputMix.connect(destination);\r\n\r\n    _stream = handledStream;\r\n}\r\n\r\nmodule.exports = voiceChanger;","// Copyright 2012, Google Inc.\r\n// All rights reserved.\r\n// \r\n// Redistribution and use in source and binary forms, with or without\r\n// modification, are permitted provided that the following conditions are\r\n// met:\r\n// \r\n//     * Redistributions of source code must retain the above copyright\r\n// notice, this list of conditions and the following disclaimer.\r\n//     * Redistributions in binary form must reproduce the above\r\n// copyright notice, this list of conditions and the following disclaimer\r\n// in the documentation and/or other materials provided with the\r\n// distribution.\r\n//     * Neither the name of Google Inc. nor the names of its\r\n// contributors may be used to endorse or promote products derived from\r\n// this software without specific prior written permission.\r\n// \r\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n\r\nfunction createFadeBuffer(context, activeTime, fadeTime) {\r\n    var length1 = activeTime * context.sampleRate;\r\n    var length2 = (activeTime - 2*fadeTime) * context.sampleRate;\r\n    var length = length1 + length2;\r\n    var buffer = context.createBuffer(1, length, context.sampleRate);\r\n    var p = buffer.getChannelData(0);\r\n    \r\n    console.log(\"createFadeBuffer() length = \" + length);\r\n    \r\n    var fadeLength = fadeTime * context.sampleRate;\r\n\r\n    var fadeIndex1 = fadeLength;\r\n    var fadeIndex2 = length1 - fadeLength;\r\n    \r\n    // 1st part of cycle\r\n    for (var i = 0; i < length1; ++i) {\r\n        var value;\r\n        \r\n        if (i < fadeIndex1) {\r\n            value = Math.sqrt(i / fadeLength);\r\n        } else if (i >= fadeIndex2) {\r\n            value = Math.sqrt(1 - (i - fadeIndex2) / fadeLength);\r\n        } else {\r\n            value = 1;\r\n        }\r\n        \r\n        p[i] = value;\r\n    }\r\n\r\n    // 2nd part\r\n    for (var i = length1; i < length; ++i) {\r\n        p[i] = 0;\r\n    }\r\n    \r\n    \r\n    return buffer;\r\n}\r\n\r\nfunction createDelayTimeBuffer(context, activeTime, fadeTime, shiftUp) {\r\n    var length1 = activeTime * context.sampleRate;\r\n    var length2 = (activeTime - 2*fadeTime) * context.sampleRate;\r\n    var length = length1 + length2;\r\n    var buffer = context.createBuffer(1, length, context.sampleRate);\r\n    var p = buffer.getChannelData(0);\r\n\r\n    console.log(\"createDelayTimeBuffer() length = \" + length);\r\n    \r\n    // 1st part of cycle\r\n    for (var i = 0; i < length1; ++i) {\r\n        if (shiftUp)\r\n          // This line does shift-up transpose\r\n          p[i] = (length1-i)/length;\r\n        else\r\n          // This line does shift-down transpose\r\n          p[i] = i / length1;\r\n    }\r\n\r\n    // 2nd part\r\n    for (var i = length1; i < length; ++i) {\r\n        p[i] = 0;\r\n    }\r\n\r\n    return buffer;\r\n}\r\n\r\nvar delayTime = 0.100;\r\nvar fadeTime = 0.050;\r\nvar bufferTime = 0.100;\r\n\r\nfunction Jungle(context) {\r\n    this.context = context;\r\n    // Create nodes for the input and output of this \"module\".\r\n    var input = context.createGain();\r\n    var output = context.createGain();\r\n    this.input = input;\r\n    this.output = output;\r\n    \r\n    // Delay modulation.\r\n    var mod1 = context.createBufferSource();\r\n    var mod2 = context.createBufferSource();\r\n    var mod3 = context.createBufferSource();\r\n    var mod4 = context.createBufferSource();\r\n    this.shiftDownBuffer = createDelayTimeBuffer(context, bufferTime, fadeTime, false);\r\n    this.shiftUpBuffer = createDelayTimeBuffer(context, bufferTime, fadeTime, true);\r\n    mod1.buffer = this.shiftDownBuffer;\r\n    mod2.buffer = this.shiftDownBuffer;\r\n    mod3.buffer = this.shiftUpBuffer;\r\n    mod4.buffer = this.shiftUpBuffer;\r\n    mod1.loop = true;\r\n    mod2.loop = true;\r\n    mod3.loop = true;\r\n    mod4.loop = true;\r\n\r\n    // for switching between oct-up and oct-down\r\n    var mod1Gain = context.createGain();\r\n    var mod2Gain = context.createGain();\r\n    var mod3Gain = context.createGain();\r\n    mod3Gain.gain.value = 0;\r\n    var mod4Gain = context.createGain();\r\n    mod4Gain.gain.value = 0;\r\n\r\n    mod1.connect(mod1Gain);\r\n    mod2.connect(mod2Gain);\r\n    mod3.connect(mod3Gain);\r\n    mod4.connect(mod4Gain);\r\n\r\n    // Delay amount for changing pitch.\r\n    var modGain1 = context.createGain();\r\n    var modGain2 = context.createGain();\r\n\r\n    var delay1 = context.createDelay();\r\n    var delay2 = context.createDelay();\r\n    mod1Gain.connect(modGain1);\r\n    mod2Gain.connect(modGain2);\r\n    mod3Gain.connect(modGain1);\r\n    mod4Gain.connect(modGain2);\r\n    modGain1.connect(delay1.delayTime);\r\n    modGain2.connect(delay2.delayTime);\r\n\r\n    // Crossfading.\r\n    var fade1 = context.createBufferSource();\r\n    var fade2 = context.createBufferSource();\r\n    var fadeBuffer = createFadeBuffer(context, bufferTime, fadeTime);\r\n    fade1.buffer = fadeBuffer\r\n    fade2.buffer = fadeBuffer;\r\n    fade1.loop = true;\r\n    fade2.loop = true;\r\n\r\n    var mix1 = context.createGain();\r\n    var mix2 = context.createGain();\r\n    mix1.gain.value = 0;\r\n    mix2.gain.value = 0;\r\n\r\n    fade1.connect(mix1.gain);    \r\n    fade2.connect(mix2.gain);\r\n        \r\n    // Connect processing graph.\r\n    input.connect(delay1);\r\n    input.connect(delay2);    \r\n    delay1.connect(mix1);\r\n    delay2.connect(mix2);\r\n    mix1.connect(output);\r\n    mix2.connect(output);\r\n    \r\n    // Start\r\n    var t = context.currentTime + 0.050;\r\n    var t2 = t + bufferTime - fadeTime;\r\n    mod1.start(t);\r\n    mod2.start(t2);\r\n    mod3.start(t);\r\n    mod4.start(t2);\r\n    fade1.start(t);\r\n    fade2.start(t2);\r\n\r\n    this.mod1 = mod1;\r\n    this.mod2 = mod2;\r\n    this.mod1Gain = mod1Gain;\r\n    this.mod2Gain = mod2Gain;\r\n    this.mod3Gain = mod3Gain;\r\n    this.mod4Gain = mod4Gain;\r\n    this.modGain1 = modGain1;\r\n    this.modGain2 = modGain2;\r\n    this.fade1 = fade1;\r\n    this.fade2 = fade2;\r\n    this.mix1 = mix1;\r\n    this.mix2 = mix2;\r\n    this.delay1 = delay1;\r\n    this.delay2 = delay2;\r\n    \r\n    this.setDelay(delayTime);\r\n}\r\n\r\nJungle.prototype.setDelay = function(delayTime) {\r\n    this.modGain1.gain.setTargetAtTime(0.5*delayTime, 0, 0.010);\r\n    this.modGain2.gain.setTargetAtTime(0.5*delayTime, 0, 0.010);\r\n}\r\n\r\nvar previousPitch = -1;\r\n\r\nJungle.prototype.setPitchOffset = function(mult) {\r\n        if (mult>0) { // pitch up\r\n            this.mod1Gain.gain.value = 0;\r\n            this.mod2Gain.gain.value = 0;\r\n            this.mod3Gain.gain.value = 1;\r\n            this.mod4Gain.gain.value = 1;\r\n        } else { // pitch down\r\n            this.mod1Gain.gain.value = 1;\r\n            this.mod2Gain.gain.value = 1;\r\n            this.mod3Gain.gain.value = 0;\r\n            this.mod4Gain.gain.value = 0;\r\n        }\r\n        this.setDelay(delayTime*Math.abs(mult));\r\n    previousPitch = mult;\r\n}\r\n\r\nmodule.exports = Jungle;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(10);\n"],"names":["root","factory","exports","module","define","amd","self","Jungle","audioContext","audioInput","effectInput","wetGain","dryGain","outputMix","currentEffectNode","_streamOrg","_stream","gotStream","stream","gain1","gain2","input","createMediaStreamSource","splitter","createChannelSplitter","merger","createChannelMerger","connect","convertToMono","createGain","Math","cos","value","PI","gain","changeEffect","val","disconnect","effect","output","setPitchOffset","getNewStream","destination","createMediaStreamDestination","handledStream","async","Promise","res","reg","AudioContext","getAudioTracks","length","navigator","getUserMedia","alert","audio","e","console","log","rej","createDelayTimeBuffer","context","activeTime","fadeTime","shiftUp","length1","sampleRate","buffer","createBuffer","p","getChannelData","i","bufferTime","this","mod1","createBufferSource","mod2","mod3","mod4","shiftDownBuffer","shiftUpBuffer","loop","mod1Gain","mod2Gain","mod3Gain","mod4Gain","modGain1","modGain2","delay1","createDelay","delay2","delayTime","fade1","fade2","fadeBuffer","fadeLength","fadeIndex1","fadeIndex2","sqrt","createFadeBuffer","mix1","mix2","t","currentTime","t2","start","setDelay","prototype","setTargetAtTime","mult","abs","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__"],"sourceRoot":""}