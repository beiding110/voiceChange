!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.voiceChanger=t():e.voiceChanger=t()}(self,(()=>{return e={10:(e,t,n)=>{const a=n(514);var r=null,i=null,o=null,c=null,s=null,u=null,f=null,l=null,h=null;function d(e){var t,n,a=r.createMediaStreamSource(e);i=function(e){var t=r.createChannelSplitter(2),n=r.createChannelMerger(2);return e.connect(t),t.connect(n,0,0),t.connect(n,0,1),n}(a),u=r.createGain(),s=r.createGain(),c=r.createGain(),o=r.createGain(),i.connect(s),i.connect(o),s.connect(u),c.connect(u),t=Math.cos(.5*Math.PI),n=Math.cos(0*Math.PI),s.gain.value=t,c.gain.value=n}function m(e=.7){f&&f.disconnect(),o&&o.disconnect();var t=new a(r);t.output.connect(c),f=t.input,t.setPitchOffset(e),i.connect(f)}function v(){var e=r.createMediaStreamDestination(),t=e.stream;u.connect(e),h=t}e.exports=async function(e,t){return new Promise(((n,a)=>{if(r=new AudioContext,e)(l=e).getAudioTracks().length?(d(l),m(t),v(),n(h)):n(l);else{if(!navigator.getUserMedia)return alert("错误：您的浏览器过于落后，不支持getUserMedia，请使用chrome、edge等现代浏览器");navigator.getUserMedia({audio:!0},(e=>{d(l=e),m(t),v(),n(h)}),(e=>{alert("错误：获取音频权限失败"),console.log(e),rej(e)}))}}))}},514:e=>{function t(e,t,n,a){var r=t*e.sampleRate,i=r+(t-2*n)*e.sampleRate,o=e.createBuffer(1,i,e.sampleRate),c=o.getChannelData(0);console.log("createDelayTimeBuffer() length = "+i);for(var s=0;s<r;++s)c[s]=a?(r-s)/i:s/r;for(s=r;s<i;++s)c[s]=0;return o}var n=.05,a=.1;function r(e){this.context=e;var r=e.createGain(),i=e.createGain();this.input=r,this.output=i;var o=e.createBufferSource(),c=e.createBufferSource(),s=e.createBufferSource(),u=e.createBufferSource();this.shiftDownBuffer=t(e,a,n,!1),this.shiftUpBuffer=t(e,a,n,!0),o.buffer=this.shiftDownBuffer,c.buffer=this.shiftDownBuffer,s.buffer=this.shiftUpBuffer,u.buffer=this.shiftUpBuffer,o.loop=!0,c.loop=!0,s.loop=!0,u.loop=!0;var f=e.createGain(),l=e.createGain(),h=e.createGain();h.gain.value=0;var d=e.createGain();d.gain.value=0,o.connect(f),c.connect(l),s.connect(h),u.connect(d);var m=e.createGain(),v=e.createGain(),p=e.createDelay(),g=e.createDelay();f.connect(m),l.connect(v),h.connect(m),d.connect(v),m.connect(p.delayTime),v.connect(g.delayTime);var G=e.createBufferSource(),y=e.createBufferSource(),B=function(e,t,n){var a=.1*e.sampleRate,r=a+0*e.sampleRate,i=e.createBuffer(1,r,e.sampleRate),o=i.getChannelData(0);console.log("createFadeBuffer() length = "+r);for(var c=.05*e.sampleRate,s=c,u=a-c,f=0;f<a;++f){var l;l=f<s?Math.sqrt(f/c):f>=u?Math.sqrt(1-(f-u)/c):1,o[f]=l}for(f=a;f<r;++f)o[f]=0;return i}(e);G.buffer=B,y.buffer=B,G.loop=!0,y.loop=!0;var x=e.createGain(),M=e.createGain();x.gain.value=0,M.gain.value=0,G.connect(x.gain),y.connect(M.gain),r.connect(p),r.connect(g),p.connect(x),g.connect(M),x.connect(i),M.connect(i);var D=e.currentTime+.05,b=D+a-n;o.start(D),c.start(b),s.start(D),u.start(b),G.start(D),y.start(b),this.mod1=o,this.mod2=c,this.mod1Gain=f,this.mod2Gain=l,this.mod3Gain=h,this.mod4Gain=d,this.modGain1=m,this.modGain2=v,this.fade1=G,this.fade2=y,this.mix1=x,this.mix2=M,this.delay1=p,this.delay2=g,this.setDelay(.1)}r.prototype.setDelay=function(e){this.modGain1.gain.setTargetAtTime(.5*e,0,.01),this.modGain2.gain.setTargetAtTime(.5*e,0,.01)},r.prototype.setPitchOffset=function(e){e>0?(this.mod1Gain.gain.value=0,this.mod2Gain.gain.value=0,this.mod3Gain.gain.value=1,this.mod4Gain.gain.value=1):(this.mod1Gain.gain.value=1,this.mod2Gain.gain.value=1,this.mod3Gain.gain.value=0,this.mod4Gain.gain.value=0),this.setDelay(.1*Math.abs(e))},e.exports=r}},t={},function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}(10);var e,t}));
//# sourceMappingURL=voiceChanger.js.map