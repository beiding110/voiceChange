!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.voiceChanger=t():e.voiceChanger=t()}(self,(()=>{return e={10:(e,t,a)=>{const n=a(514);var r=null,i=null,o=null,c=null,s=null,f=null,u=null,l=null;function h(e){var t,a,n=r.createMediaStreamSource(e);i=function(e){var t=r.createChannelSplitter(2),a=r.createChannelMerger(2);return e.connect(t),t.connect(a,0,0),t.connect(a,0,1),a}(n),f=r.createGain(),s=r.createGain(),c=r.createGain(),o=r.createGain(),i.connect(s),i.connect(o),s.connect(f),c.connect(f),t=Math.cos(.5*Math.PI),a=Math.cos(0*Math.PI),s.gain.value=t,c.gain.value=a}function d(e=.7){u&&u.disconnect(),o&&o.disconnect();var t=new n(r);t.output.connect(c),u=t.input,t.setPitchOffset(e),i.connect(u)}function m(){var e=r.createMediaStreamDestination(),t=e.stream;f.connect(e),l=t}e.exports=async function(e,t){return new Promise(((a,n)=>{if(r=new AudioContext,e)h(e),d(t),m(),a(l);else{if(!navigator.getUserMedia)return alert("错误：您的浏览器过于落后，不支持getUserMedia，请使用chrome、edge等现代浏览器");navigator.getUserMedia({audio:!0},(e=>{h(e),d(t),m(),a(l)}),(e=>{alert("错误：获取音频权限失败"),console.log(e),rej(e)}))}}))}},514:e=>{function t(e,t,a,n){var r=t*e.sampleRate,i=r+(t-2*a)*e.sampleRate,o=e.createBuffer(1,i,e.sampleRate),c=o.getChannelData(0);console.log("createDelayTimeBuffer() length = "+i);for(var s=0;s<r;++s)c[s]=n?(r-s)/i:s/r;for(s=r;s<i;++s)c[s]=0;return o}var a=.05,n=.1;function r(e){this.context=e;var r=e.createGain(),i=e.createGain();this.input=r,this.output=i;var o=e.createBufferSource(),c=e.createBufferSource(),s=e.createBufferSource(),f=e.createBufferSource();this.shiftDownBuffer=t(e,n,a,!1),this.shiftUpBuffer=t(e,n,a,!0),o.buffer=this.shiftDownBuffer,c.buffer=this.shiftDownBuffer,s.buffer=this.shiftUpBuffer,f.buffer=this.shiftUpBuffer,o.loop=!0,c.loop=!0,s.loop=!0,f.loop=!0;var u=e.createGain(),l=e.createGain(),h=e.createGain();h.gain.value=0;var d=e.createGain();d.gain.value=0,o.connect(u),c.connect(l),s.connect(h),f.connect(d);var m=e.createGain(),v=e.createGain(),p=e.createDelay(),g=e.createDelay();u.connect(m),l.connect(v),h.connect(m),d.connect(v),m.connect(p.delayTime),v.connect(g.delayTime);var G=e.createBufferSource(),y=e.createBufferSource(),B=function(e,t,a){var n=.1*e.sampleRate,r=n+0*e.sampleRate,i=e.createBuffer(1,r,e.sampleRate),o=i.getChannelData(0);console.log("createFadeBuffer() length = "+r);for(var c=.05*e.sampleRate,s=c,f=n-c,u=0;u<n;++u){var l;l=u<s?Math.sqrt(u/c):u>=f?Math.sqrt(1-(u-f)/c):1,o[u]=l}for(u=n;u<r;++u)o[u]=0;return i}(e);G.buffer=B,y.buffer=B,G.loop=!0,y.loop=!0;var x=e.createGain(),M=e.createGain();x.gain.value=0,M.gain.value=0,G.connect(x.gain),y.connect(M.gain),r.connect(p),r.connect(g),p.connect(x),g.connect(M),x.connect(i),M.connect(i);var D=e.currentTime+.05,b=D+n-a;o.start(D),c.start(b),s.start(D),f.start(b),G.start(D),y.start(b),this.mod1=o,this.mod2=c,this.mod1Gain=u,this.mod2Gain=l,this.mod3Gain=h,this.mod4Gain=d,this.modGain1=m,this.modGain2=v,this.fade1=G,this.fade2=y,this.mix1=x,this.mix2=M,this.delay1=p,this.delay2=g,this.setDelay(.1)}r.prototype.setDelay=function(e){this.modGain1.gain.setTargetAtTime(.5*e,0,.01),this.modGain2.gain.setTargetAtTime(.5*e,0,.01)},r.prototype.setPitchOffset=function(e){e>0?(this.mod1Gain.gain.value=0,this.mod2Gain.gain.value=0,this.mod3Gain.gain.value=1,this.mod4Gain.gain.value=1):(this.mod1Gain.gain.value=1,this.mod2Gain.gain.value=1,this.mod3Gain.gain.value=0,this.mod4Gain.gain.value=0),this.setDelay(.1*Math.abs(e))},e.exports=r}},t={},function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}(10);var e,t}));